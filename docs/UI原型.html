<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedicalTemplate - 脊柱外科病历模板管理</title>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #4caf50;
            --background: #f8f9fa;
            --sidebar-bg: #ffffff;
            --card-bg: #ffffff;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --border: #dadce0;
            --success: #34a853;
            --warning: #f9ab00;
            --danger: #ea4335;
            --medical-blue: #0288d1;
            --medical-green: #43a047;
            --cervical: #8e24aa;
            --lumbar: #43a047;
            --scoliosis: #e53935;
            --trauma: #1e88e5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-primary);
            overflow: hidden;
        }

        /* 标题栏 */
        .title-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 40px;
            background: linear-gradient(to right, #0d47a1, #1a73e8);
            color: white;
            padding: 0 10px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .title-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .title-icon {
            font-size: 18px;
        }

        .app-title {
            font-weight: 500;
            font-size: 15px;
        }

        .title-menu {
            display: flex;
            gap: 20px;
            margin-left: 30px;
            font-size: 13px;
        }

        .menu-item {
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .window-controls {
            display: flex;
        }

        .window-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
        }

        .window-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .close-btn:hover {
            background: #e53935;
        }

        /* 主容器 */
        .main-container {
            display: flex;
            height: 100vh;
            padding-top: 40px;
        }

        /* 侧边导航 */
        .sidebar {
            width: 220px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            z-index: 10;
            padding-top: 10px;
        }

        /* 侧边栏搜索 */
        .sidebar-search {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .sidebar-search .search-bar {
            position: relative;
        }

        .sidebar-search input {
            width: 100%;
            padding: 8px 15px 8px 35px;
            border-radius: 20px;
            border: 1px solid var(--border);
            font-size: 13px;
            transition: all 0.3s;
            background: #f1f3f4;
        }

        .sidebar-search input:focus {
            background: white;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
            outline: none;
        }

        .sidebar-search iconify-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* 筛选功能区 */
        .filter-section {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--text-primary);
        }

        .section-title iconify-icon {
            color: var(--primary);
            font-size: 14px;
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }

        .filter-option {
            padding: 4px 10px;
            border-radius: 14px;
            font-size: 12px;
            cursor: pointer;
            background: #f1f3f4;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .filter-option.active {
            background: var(--primary);
            color: white;
        }

        .sort-options {
            display: flex;
            gap: 6px;
        }

        .sort-option {
            flex: 1;
            padding: 6px;
            border-radius: 4px;
            font-size: 12px;
            text-align: center;
            cursor: pointer;
            background: #f1f3f4;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .sort-option.active {
            background: var(--primary);
            color: white;
        }

        .nav-section {
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
            flex: 1;
            overflow-y: auto;
        }

        .nav-title {
            padding: 0 15px 10px;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-item:hover {
            background: rgba(0, 0, 0, 0.03);
            color: var(--primary);
        }

        .nav-item.active {
            background: rgba(26, 115, 232, 0.08);
            color: var(--primary);
            border-left: 4px solid var(--primary);
        }

        .nav-item.add-disease-btn {
            color: var(--primary);
            font-weight: 500;
            margin-top: 10px;
            background: rgba(26, 115, 232, 0.05);
            border: 1px dashed var(--primary);
            border-radius: 4px;
            margin-left: 10px;
            margin-right: 10px;
        }

        .nav-item iconify-icon {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            font-size: 16px;
        }

        .disease-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 11px;
            margin-left: auto;
        }

        .cervical-badge {
            background: rgba(142, 36, 170, 0.1);
            color: var(--cervical);
        }

        .lumbar-badge {
            background: rgba(67, 160, 71, 0.1);
            color: var(--lumbar);
        }

        .scoliosis-badge {
            background: rgba(229, 57, 53, 0.1);
            color: var(--scoliosis);
        }

        .trauma-badge {
            background: rgba(30, 136, 229, 0.1);
            color: var(--trauma);
        }

        /* 主内容区 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* 内容区 */
        .content-area {
            flex: 1;
            display: flex;
            overflow: hidden;
            padding: 15px;
            gap: 15px;
        }

        /* 模板列表区 */
        .template-list-section {
            width: 260px;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .section-header {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            background: #f8f9fa;
        }

        .template-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-options {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .view-option {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            background: #f1f3f4;
            color: var(--text-secondary);
        }

        .view-option.active {
            background: var(--primary);
            color: white;
        }

        .template-list {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .template-card {
            padding: 12px;
            border-radius: 8px;
            background: var(--card-bg);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid var(--border);
            position: relative;
        }

        .template-card:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 6px rgba(26, 115, 232, 0.1);
        }

        .template-card.active {
            border-color: var(--primary);
            background: rgba(26, 115, 232, 0.05);
        }

        .template-card h3 {
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .template-card h3 iconify-icon {
            color: var(--secondary);
            font-size: 14px;
        }

        .template-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 8px;
        }

        .template-tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            background: #e8f0fe;
            color: var(--primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .template-tag:hover {
            background: rgba(26, 115, 232, 0.2);
        }

        /* 标签管理区域样式 */
        .tag-management {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            display: none;
            flex-wrap: wrap;
            gap: 8px;
            background: #f8f9fa;
        }

        .tag-management.active {
            display: flex;
        }

        .tag-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 4px 8px;
            border-radius: 15px;
            background: #e8f0fe;
            color: var(--primary);
            font-size: 12px;
        }

        .tag-item iconify-icon {
            cursor: pointer;
            font-size: 12px;
        }

        .tag-item iconify-icon:hover {
            color: var(--danger);
        }

        .add-tag-input {
            padding: 4px 8px;
            border-radius: 15px;
            border: 1px dashed var(--primary);
            background: white;
            color: var(--text-primary);
            font-size: 12px;
            width: 100px;
            outline: none;
        }

        .add-tag-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }

        .template-meta {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .disease-tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: 500;
        }

        .cervical {
            background: rgba(142, 36, 170, 0.1);
            color: var(--cervical);
        }

        .lumbar {
            background: rgba(67, 160, 71, 0.1);
            color: var(--lumbar);
        }

        .scoliosis {
            background: rgba(229, 57, 53, 0.1);
            color: var(--scoliosis);
        }

        .trauma {
            background: rgba(30, 136, 229, 0.1);
            color: var(--trauma);
        }

        iconify-icon.favorite {
            position: absolute;
            top: 12px;
            right: 12px;
            color: #ddd;
            cursor: pointer;
            font-size: 14px;
        }

        iconify-icon.favorite.active {
            color: var(--warning);
        }

        /* 编辑区 */
        .editor-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            background: #f8f9fa;
        }

        .editor-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
            /* 使按钮右对齐 */
        }

        /* 删除了编辑、预览tab相关的CSS */

        .editor-toolbar {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 6px;
        }

        .tool-group {
            display: flex;
            gap: 3px;
            padding: 3px;
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.02);
        }

        .tool-btn {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 16px;
        }

        .tool-btn:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .variable-palette {
            display: flex;
            gap: 6px;
            margin-left: 8px;
            flex-wrap: wrap;
        }

        .variable-btn,
        .action-btn {
            padding: 4px 8px;
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            border: none;
        }

        .variable-btn:hover,
        .action-btn:hover {
            background: rgba(26, 115, 232, 0.15);
        }

        .action-btn.edit-btn {
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
        }

        .action-btn.save-btn {
            background: rgba(67, 160, 71, 0.1);
            color: var(--success);
        }

        .action-btn.cancel-btn {
            background: rgba(234, 67, 53, 0.1);
            color: var(--danger);
        }

        .action-btn.edit-btn:hover {
            background: rgba(26, 115, 232, 0.2);
        }

        .action-btn.save-btn:hover {
            background: rgba(67, 160, 71, 0.2);
        }

        .action-btn.cancel-btn:hover {
            background: rgba(234, 67, 53, 0.2);
        }

        .editor-content {
            flex: 1;
            overflow: hidden;
            display: flex;
        }

        .editor-pane {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: none;
        }

        .editor-pane.active {
            display: block;
        }

        .editor-pane h2 {
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            color: var(--primary);
            font-size: 18px;
        }

        .template-content {
            line-height: 1.6;
            font-size: 14px;
        }

        .variable {
            background: rgba(255, 152, 0, 0.15);
            color: #f57c00;
            border-radius: 3px;
            padding: 0 3px;
            border: 1px dashed rgba(245, 124, 0, 0.4);
            font-weight: 500;
        }

        .medical-section {
            margin-bottom: 20px;
            padding: 12px;
            border-radius: 6px;
            background: #f8f9fa;
            border-left: 3px solid var(--primary);
            position: relative;
        }

        .medical-section h3 {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 15px;
        }

        .medical-section h3 iconify-icon {
            color: var(--secondary);
        }

        .copy-btn {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(26, 115, 232, 0.1);
            color: var(--primary);
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            opacity: 0.7;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: rgba(26, 115, 232, 0.2);
            opacity: 1;
        }

        /* 底部状态栏 */
        .status-bar {
            height: 30px;
            background: white;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 15px;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-right: 15px;
        }

        .status-item iconify-icon {
            font-size: 12px;
        }

        /* 预览状态下隐藏工具栏 */
        .preview-mode .editor-toolbar {
            display: none;
        }
    </style>
</head>

<body>
    <!-- 标题栏 -->
    <div class="title-bar">
        <div class="title-left">
            <div class="title-icon">
                <iconify-icon icon="fa6-solid:bone"></iconify-icon>
            </div>
            <div class="app-title">SpineTemplate Pro</div>
            <div class="title-menu">
                <div class="menu-item">文件</div>
                <div class="menu-item">编辑</div>
                <div class="menu-item">视图</div>
                <div class="menu-item">帮助</div>
            </div>
        </div>
        <div class="window-controls">
            <div class="window-btn" id="pin-btn" title="置顶">
                <iconify-icon icon="fa6-solid:thumbtack"></iconify-icon>
            </div>
            <div class="window-btn" id="min-btn" title="最小化">
                <iconify-icon icon="fa6-solid:window-minimize"></iconify-icon>
            </div>
            <div class="window-btn" id="max-btn" title="最大化">
                <iconify-icon icon="fa6-solid:window-maximize"></iconify-icon>
            </div>
            <div class="window-btn close-btn" id="close-btn" title="关闭">
                <iconify-icon icon="fa6-solid:times"></iconify-icon>
            </div>
        </div>
    </div>

    <!-- 主容器 -->
    <div class="main-container">
        <!-- 侧边导航 -->
        <div class="sidebar">
            <!-- 侧边栏搜索 -->
            <div class="sidebar-search">
                <div class="search-bar">
                    <iconify-icon icon="fa6-solid:search"></iconify-icon>
                    <input type="text" placeholder="搜索模板、病种或关键词...">
                </div>
            </div>

            <!-- 筛选功能区 -->
            <div class="filter-section">
                <div class="section-title">
                    <iconify-icon icon="fa6-solid:filter"></iconify-icon>
                    <span>筛选模板</span>
                </div>

                <div class="filter-options">
                    <div class="filter-option active">全部</div>
                    <div class="filter-option">常用</div>
                    <div class="filter-option">收藏</div>
                    <div class="filter-option">最近</div>
                </div>

                <div class="section-title">
                    <iconify-icon icon="fa6-solid:tags"></iconify-icon>
                    <span>标签筛选</span>
                </div>

                <div class="filter-options tag-filter-options">
                    <div class="filter-option tag-filter">初诊</div>
                    <div class="filter-option tag-filter">随访</div>
                    <div class="filter-option tag-filter">术后</div>
                    <div class="filter-option tag-filter">康复</div>
                    <div class="filter-option tag-filter">手术</div>
                    <div class="filter-option tag-filter">微创</div>
                    <div class="filter-option tag-filter">评估</div>
                    <div class="filter-option tag-filter">非手术</div>
                </div>

                <div class="section-title">
                    <iconify-icon icon="fa6-solid:sort"></iconify-icon>
                    <span>排序方式</span>
                </div>

                <div class="sort-options">
                    <div class="sort-option active">最新</div>
                    <div class="sort-option">最旧</div>
                    <div class="sort-option">名称</div>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">脊柱外科病种</div>
                <div class="nav-item active">
                    <iconify-icon icon="fa6-solid:user-injured"></iconify-icon>
                    <span>颈椎病</span>
                    <span class="disease-badge cervical-badge">12</span>
                </div>
                <div class="nav-item">
                    <iconify-icon icon="fa6-solid:spine"></iconify-icon>
                    <span>腰椎间盘突出</span>
                    <span class="disease-badge lumbar-badge">15</span>
                </div>
                <div class="nav-item">
                    <iconify-icon icon="fa6-solid:bone"></iconify-icon>
                    <span>脊柱侧弯</span>
                    <span class="disease-badge scoliosis-badge">8</span>
                </div>
                <div class="nav-item">
                    <iconify-icon icon="fa6-solid:crutch"></iconify-icon>
                    <span>脊柱创伤</span>
                    <span class="disease-badge trauma-badge">10</span>
                </div>
                <div class="nav-item">
                    <iconify-icon icon="fa6-solid:wheelchair"></iconify-icon>
                    <span>椎管狭窄</span>
                </div>
                <div class="nav-item">
                    <iconify-icon icon="fa6-solid:procedures"></iconify-icon>
                    <span>脊柱肿瘤</span>
                </div>
                <div class="nav-item add-disease-btn">
                    <iconify-icon icon="fa6-solid:plus"></iconify-icon>
                    <span>添加病种</span>
                </div>
            </div>
        </div>

        <!-- 主内容区 -->
        <div class="main-content">
            <!-- 内容区 -->
            <div class="content-area">
                <!-- 模板列表区 -->
                <div class="template-list-section">
                    <div class="section-header">
                        <div class="section-title">
                            <iconify-icon icon="fa6-solid:file-medical"></iconify-icon>
                            <span>腰椎间盘突出模板</span>
                        </div>
                        <div class="template-actions">
                            <button class="action-btn">
                                <iconify-icon icon="fa6-solid:plus"></iconify-icon>
                                添加
                            </button>
                            <button class="action-btn">
                                <iconify-icon icon="fa6-solid:copy"></iconify-icon>
                                复制
                            </button>
                            <button class="action-btn">
                                <iconify-icon icon="fa6-solid:trash"></iconify-icon>
                                删除
                            </button>
                        </div>
                    </div>

                    <div class="template-list">
                        <div class="template-card active">
                            <iconify-icon icon="fa6-solid:star" class="favorite active"></iconify-icon>
                            <h3><iconify-icon icon="fa6-solid:file-medical"></iconify-icon> 腰椎间盘突出初诊病历</h3>
                            <div class="template-tags">
                                <span class="template-tag">初诊</span>
                                <span class="template-tag">评估</span>
                                <span class="template-tag">非手术</span>
                            </div>
                            <div class="template-meta">
                                <div>2023-09-15</div>
                                <div class="disease-tag lumbar">腰椎</div>
                            </div>
                        </div>

                        <div class="template-card">
                            <iconify-icon icon="fa6-solid:star" class="favorite"></iconify-icon>
                            <h3><iconify-icon icon="fa6-solid:file-medical"></iconify-icon> 腰椎术后随访记录</h3>
                            <div class="template-tags">
                                <span class="template-tag">随访</span>
                                <span class="template-tag">术后</span>
                                <span class="template-tag">康复</span>
                            </div>
                            <div class="template-meta">
                                <div>2023-09-10</div>
                                <div class="disease-tag lumbar">腰椎</div>
                            </div>
                        </div>

                        <div class="template-card">
                            <iconify-icon icon="fa6-solid:star" class="favorite active"></iconify-icon>
                            <h3><iconify-icon icon="fa6-solid:file-medical"></iconify-icon> 腰椎微创手术记录</h3>
                            <div class="template-tags">
                                <span class="template-tag">手术</span>
                                <span class="template-tag">微创</span>
                                <span class="template-tag">记录</span>
                            </div>
                            <div class="template-meta">
                                <div>2023-08-28</div>
                                <div class="disease-tag lumbar">腰椎</div>
                            </div>
                        </div>

                        <div class="template-card">
                            <iconify-icon icon="fa6-solid:star" class="favorite"></iconify-icon>
                            <h3><iconify-icon icon="fa6-solid:file-medical"></iconify-icon> 腰椎术后康复指导</h3>
                            <div class="template-tags">
                                <span class="template-tag">康复</span>
                                <span class="template-tag">术后</span>
                                <span class="template-tag">指导</span>
                            </div>
                            <div class="template-meta">
                                <div>2023-08-20</div>
                                <div class="disease-tag lumbar">腰椎</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 编辑预览区 -->
                <div class="editor-section">
                    <div class="editor-header">
                        <!-- 标签管理区域 -->
                        <div class="tag-management active" id="tag-management">
                            <div class="tag-item">
                                <span>初诊</span>
                                <iconify-icon icon="fa6-solid:times"></iconify-icon>
                            </div>
                            <div class="tag-item">
                                <span>评估</span>
                                <iconify-icon icon="fa6-solid:times"></iconify-icon>
                            </div>
                            <div class="tag-item">
                                <span>非手术</span>
                                <iconify-icon icon="fa6-solid:times"></iconify-icon>
                            </div>
                            <input type="text" class="add-tag-input" placeholder="添加标签..." id="add-tag-input">
                        </div>

                        <div class="editor-actions">
                            <button class="variable-btn" id="manage-tags-btn">
                                <iconify-icon icon="fa6-solid:tags"></iconify-icon>
                                管理标签
                            </button>
                            <button class="action-btn edit-btn" id="edit-btn">
                                <iconify-icon icon="fa6-solid:edit"></iconify-icon>
                                编辑
                            </button>
                            <button class="action-btn save-btn" id="save-btn" style="display: none;">
                                <iconify-icon icon="fa6-solid:save"></iconify-icon>
                                保存
                            </button>
                            <button class="action-btn cancel-btn" id="cancel-btn" style="display: none;">
                                <iconify-icon icon="fa6-solid:times"></iconify-icon>
                                取消
                            </button>

                        </div>
                    </div>




                    <div class="editor-content">
                        <div class="editor-pane" id="editor-pane">
                            <h2>腰椎间盘突出初诊病历模板</h2>
                            <div class="editor-toolbar">
                                <div class="tool-group">
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:bold"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:italic"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:underline"></iconify-icon></div>
                                </div>

                                <div class="tool-group">
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:list-ul"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:list-ol"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:outdent"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:indent"></iconify-icon></div>
                                </div>

                                <div class="tool-group">
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:link"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:image"></iconify-icon></div>
                                    <div class="tool-btn"><iconify-icon icon="fa6-solid:table"></iconify-icon></div>
                                </div>

                                <div class="variable-palette">
                                    <div class="variable-btn">
                                        <iconify-icon icon="fa6-solid:user"></iconify-icon>
                                        患者姓名
                                    </div>
                                    <div class="variable-btn">
                                        <iconify-icon icon="fa6-solid:id-card"></iconify-icon>
                                        病历号
                                    </div>
                                    <div class="variable-btn">
                                        <iconify-icon icon="fa6-solid:venus-mars"></iconify-icon>
                                        性别
                                    </div>
                                    <div class="variable-btn">
                                        <iconify-icon icon="fa6-solid:birthday-cake"></iconify-icon>
                                        年龄
                                    </div>
                                </div>
                            </div>

                            <div class="template-content">
                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:user-injured"></iconify-icon> 基本信息</h3>
                                    <p>姓名: <span class="variable">{患者姓名}</span> &emsp; 性别: <span
                                            class="variable">{性别}</span> &emsp; 年龄: <span class="variable">{年龄}</span>岁
                                    </p>
                                    <p>病历号: <span class="variable">{病历号}</span> &emsp; 职业: <span
                                            class="variable">{职业}</span> &emsp; 就诊日期: <span class="variable">{日期}</span>
                                    </p>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:stethoscope"></iconify-icon> 主诉</h3>
                                    <p>腰部疼痛<span class="variable">{时间}</span>，<span
                                            class="variable">{放射部位}</span>放射痛<span class="variable">{时间}</span>，加重<span
                                            class="variable">{时间}</span>。</p>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:history"></iconify-icon> 现病史</h3>
                                    <p>患者<span class="variable">{时间}</span>前无明显诱因出现腰部疼痛，呈<span
                                            class="variable">{性质}</span>，活动后加重，休息后稍缓解。后逐渐出现<span
                                            class="variable">{放射部位}</span>放射痛，伴<span class="variable">{伴随症状}</span>。</p>
                                    <p>曾于<span class="variable">{时间}</span>接受<span class="variable">{治疗}</span>，效果<span
                                            class="variable">{效果}</span>。本次因<span class="variable">{加重原因}</span>症状加重来诊。
                                    </p>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:heartbeat"></iconify-icon> 体格检查</h3>
                                    <ul>
                                        <li>步态：<span class="variable">{步态}</span></li>
                                        <li>腰椎活动度：前屈 <span class="variable">{前屈角度}</span>°，后伸 <span
                                                class="variable">{后伸角度}</span>°，左右侧屈 <span
                                                class="variable">{侧屈角度}</span>°</li>
                                        <li>压痛：L<span class="variable">{节段}</span>/S1 棘突及椎旁压痛(+)</li>
                                        <li>直腿抬高试验：左侧 <span class="variable">{左侧角度}</span>°，右侧 <span
                                                class="variable">{右侧角度}</span>°</li>
                                        <li>感觉检查：<span class="variable">{感觉异常区域}</span>感觉减退</li>
                                        <li>肌力：<span class="variable">{肌力异常}</span>肌力Ⅳ级</li>
                                        <li>反射：膝反射<span class="variable">{膝反射}</span>，踝反射<span
                                                class="variable">{踝反射}</span>，病理征(-)</li>
                                    </ul>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:vial"></iconify-icon> 影像学检查</h3>
                                    <ul>
                                        <li>腰椎X线：<span class="variable">{X线表现}</span></li>
                                        <li>腰椎MRI：L<span class="variable">{节段}</span>/S1 椎间盘向<span
                                                class="variable">{方向}</span>突出，压迫<span
                                                class="variable">{受压结构}</span>，硬膜囊受压</li>
                                        <li>诊断：L<span class="variable">{节段}</span>/S1 椎间盘突出症</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="editor-pane active" id="preview-pane">
                            <div class="template-content">
                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:user-injured"></iconify-icon> 基本信息</h3>
                                    <p>姓名: 张伟 &emsp; 性别: 男 &emsp; 年龄: 45岁</p>
                                    <p>病历号: SP20230915012 &emsp; 职业: 司机 &emsp; 就诊日期: 2023-09-15</p>
                                    <button class="copy-btn" data-section="basic-info">
                                        <iconify-icon icon="fa6-solid:copy"></iconify-icon> 复制
                                    </button>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:stethoscope"></iconify-icon> 主诉</h3>
                                    <p>腰部疼痛3年，左下肢放射痛6个月，加重1周。</p>
                                    <button class="copy-btn" data-section="chief-complaint">
                                        <iconify-icon icon="fa6-solid:copy"></iconify-icon> 复制
                                    </button>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:history"></iconify-icon> 现病史</h3>
                                    <p>患者3年前无明显诱因出现腰部疼痛，呈持续性钝痛，活动后加重，休息后稍缓解。后逐渐出现左下肢后外侧放射痛，伴左足背麻木感。</p>
                                    <p>曾于6个月前接受物理治疗，效果欠佳。本次因长途驾驶后症状加重来诊。</p>
                                    <button class="copy-btn" data-section="present-illness">
                                        <iconify-icon icon="fa6-solid:copy"></iconify-icon> 复制
                                    </button>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:heartbeat"></iconify-icon> 体格检查</h3>
                                    <ul>
                                        <li>步态：跛行，左侧避痛步态</li>
                                        <li>腰椎活动度：前屈 40°，后伸 15°，左右侧屈 20°</li>
                                        <li>压痛：L4/5、L5/S1 棘突及左侧椎旁压痛(+)</li>
                                        <li>直腿抬高试验：左侧 40°，右侧 70°</li>
                                        <li>感觉检查：左足背及第一趾蹼区感觉减退</li>
                                        <li>肌力：左足背伸肌力Ⅳ级</li>
                                        <li>反射：膝反射对称(++)，左踝反射减弱(+)，病理征(-)</li>
                                    </ul>
                                    <button class="copy-btn" data-section="physical-exam">
                                        <iconify-icon icon="fa6-solid:copy"></iconify-icon> 复制
                                    </button>
                                </div>

                                <div class="medical-section">
                                    <h3><iconify-icon icon="fa6-solid:vial"></iconify-icon> 影像学检查</h3>
                                    <ul>
                                        <li>腰椎X线：腰椎生理曲度变直，L4/5椎间隙变窄</li>
                                        <li>腰椎MRI：L4/5椎间盘向左后突出，压迫左侧L5神经根，硬膜囊受压</li>
                                        <li>诊断：L4/5椎间盘突出症</li>
                                    </ul>
                                    <button class="copy-btn" data-section="imaging">
                                        <iconify-icon icon="fa6-solid:copy"></iconify-icon> 复制
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 底部状态栏 -->
            <div class="status-bar">
                <div class="status-item">
                    <iconify-icon icon="fa6-solid:info-circle"></iconify-icon>
                    <span>当前模板: 腰椎间盘突出初诊病历</span>
                </div>
                <div class="status-item">
                    <iconify-icon icon="fa6-solid:clock"></iconify-icon>
                    <span>最后修改: 2023-09-15 14:30</span>
                </div>
                <div class="status-item">
                    <iconify-icon icon="fa6-solid:database"></iconify-icon>
                    <span>本地存储 | 已加密</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 编辑状态标志
        let isEditMode = false;

        // 模板卡片交互
        document.querySelectorAll('.template-card').forEach(card => {
            card.addEventListener('click', function () {
                document.querySelectorAll('.template-card').forEach(c => {
                    c.classList.remove('active');
                });
                this.classList.add('active');

                // 更新底部状态栏
                const title = this.querySelector('h3').textContent;
                document.querySelector('.status-bar .status-item:first-child span').textContent = `当前模板: ${title}`;
            });
        });

        // 收藏星标交互
        document.querySelectorAll('iconify-icon.favorite').forEach(star => {
            star.addEventListener('click', function (e) {
                e.stopPropagation();
                this.classList.toggle('active');
            });
        });

        // 导航菜单交互
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function () {
                document.querySelectorAll('.nav-item').forEach(i => {
                    i.classList.remove('active');
                });
                this.classList.add('active');

                // 更新模板列表标题
                const title = this.querySelector('span').textContent;
                document.querySelector('.section-header .section-title span').textContent = `${title}模板`;
            });
        });

        // 筛选选项交互
        document.querySelectorAll('.filter-option').forEach(option => {
            option.addEventListener('click', function () {
                document.querySelectorAll('.filter-option').forEach(o => {
                    o.classList.remove('active');
                });
                this.classList.add('active');
            });
        });

        // 排序选项交互
        document.querySelectorAll('.sort-option').forEach(option => {
            option.addEventListener('click', function () {
                document.querySelectorAll('.sort-option').forEach(o => {
                    o.classList.remove('active');
                });
                this.classList.add('active');
            });
        });

        // 删除了模板编辑/预览切换的tab点击事件处理

        // 初始设置预览模式
        document.querySelector('.editor-section').classList.add('preview-mode');



        // 编辑、保存、取消按钮功能
        const editBtn = document.getElementById('edit-btn');
        const saveBtn = document.getElementById('save-btn');
        const cancelBtn = document.getElementById('cancel-btn');
        const editorPane = document.getElementById('editor-pane');
        const previewPane = document.getElementById('preview-pane');

        // 确保初始状态下预览面板可见，编辑面板隐藏
        previewPane.classList.add('active');
        editorPane.classList.remove('active');

        // 存储原始内容，用于取消编辑时恢复
        let originalContent = '';

        // 编辑按钮点击事件
        editBtn.addEventListener('click', function () {
            // 切换到编辑模式
            isEditMode = true;

            // 保存原始内容以便取消时恢复
            originalContent = editorPane.innerHTML;

            // 显示保存和取消按钮，隐藏编辑按钮
            editBtn.style.display = 'none';
            saveBtn.style.display = 'flex';
            cancelBtn.style.display = 'flex';

            // 显示编辑面板，隐藏预览面板
            editorPane.classList.add('active');
            previewPane.classList.remove('active');

            // 更新工具栏显示
            document.querySelector('.editor-section').classList.remove('preview-mode');
        });

        // 保存按钮点击事件
        saveBtn.addEventListener('click', function () {
            // 退出编辑模式
            isEditMode = false;

            // 在实际应用中，这里会保存编辑的内容
            console.log('保存内容');

            // 更新预览内容（实际应用中会根据编辑内容更新）
            // 这里仅作为示例

            // 隐藏保存和取消按钮，显示编辑按钮
            editBtn.style.display = 'flex';
            saveBtn.style.display = 'none';
            cancelBtn.style.display = 'none';

            // 显示预览面板，隐藏编辑面板
            previewPane.classList.add('active');
            editorPane.classList.remove('active');

            // 更新工具栏显示
            document.querySelector('.editor-section').classList.add('preview-mode');
        });

        // 取消按钮点击事件
        cancelBtn.addEventListener('click', function () {
            // 退出编辑模式
            isEditMode = false;

            // 恢复原始内容
            editorPane.innerHTML = originalContent;

            // 隐藏保存和取消按钮，显示编辑按钮
            editBtn.style.display = 'flex';
            saveBtn.style.display = 'none';
            cancelBtn.style.display = 'none';

            // 显示预览面板，隐藏编辑面板
            previewPane.classList.add('active');
            editorPane.classList.remove('active');

            // 更新工具栏显示
            document.querySelector('.editor-section').classList.add('preview-mode');
        });

        // 变量按钮点击
        document.querySelectorAll('.variable-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const text = this.textContent.trim();
                // 在实际应用中，这里会将变量插入到编辑器中
                console.log(`插入变量: ${text}`);
            });
        });

        // 模板操作按钮点击
        document.querySelectorAll('.template-actions .action-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const action = this.textContent.trim();
                console.log(`执行模板操作: ${action}`);

                // 根据不同按钮执行不同操作
                if (action.includes('添加')) {
                    console.log('添加新模板');
                    // 这里添加创建新模板的逻辑
                } else if (action.includes('复制')) {
                    console.log('复制当前模板');
                    // 这里添加复制模板的逻辑
                } else if (action.includes('删除')) {
                    console.log('删除当前模板');
                    // 这里添加删除模板的逻辑
                    if (confirm('确定要删除当前模板吗？')) {
                        // 执行删除操作
                    }
                }
            });
        });

        // 添加病种按钮点击
        document.querySelector('.add-disease-btn').addEventListener('click', function () {
            console.log('添加新病种');
            // 这里添加创建新病种的逻辑
            const newDiseaseName = prompt('请输入新病种名称:');
            if (newDiseaseName && newDiseaseName.trim() !== '') {
                console.log(`创建新病种: ${newDiseaseName}`);
                // 在实际应用中，这里会创建新病种并添加到列表中
            }
        });

        // 段落复制功能
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const sectionId = this.getAttribute('data-section');
                const section = this.closest('.medical-section');
                const content = section.querySelector('p, ul').textContent || section.textContent;

                // 复制到剪贴板
                navigator.clipboard.writeText(content).then(() => {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<iconify-icon icon="fa6-solid:check"></iconify-icon> 已复制';
                    this.style.background = 'var(--success)';
                    this.style.color = 'white';

                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.background = 'rgba(26, 115, 232, 0.1)';
                        this.style.color = 'var(--primary)';
                    }, 2000);
                });
            });
        });

        // 窗口控制按钮
        let pinned = false;
        document.getElementById('pin-btn').addEventListener('click', function () {
            pinned = !pinned;
            this.style.background = pinned ? 'rgba(255,255,255,0.3)' : 'transparent';
            const iconElement = this.querySelector('iconify-icon');
            if (pinned) {
                iconElement.style.transform = 'rotate(90deg)';
            } else {
                iconElement.style.transform = '';
            }
        });

        // 标签管理功能
        const tagManagement = document.getElementById('tag-management');
        const addTagInput = document.getElementById('add-tag-input');


        // 添加新标签
        addTagInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter' && this.value.trim() !== '') {
                const tagText = this.value.trim();

                // 创建新标签元素
                const newTag = document.createElement('div');
                newTag.className = 'tag-item';
                newTag.innerHTML = `
                    <span>${tagText}</span>
                    <iconify-icon icon="fa6-solid:times"></iconify-icon>
                `;

                // 添加删除标签的事件监听
                newTag.querySelector('iconify-icon').addEventListener('click', function () {
                    newTag.remove();
                    updateTemplateTags(tagText, 'remove');
                });

                // 将新标签添加到标签管理区域
                tagManagement.insertBefore(newTag, addTagInput);

                // 更新模板标签
                updateTemplateTags(tagText, 'add');

                // 添加到标签筛选选项
                addTagToFilterOptions(tagText);

                // 清空输入框
                this.value = '';
            }
        });

        // 初始化标签删除功能
        document.querySelectorAll('.tag-item iconify-icon').forEach(icon => {
            icon.addEventListener('click', function () {
                const tagItem = this.parentElement;
                const tagText = tagItem.querySelector('span').textContent;
                tagItem.remove();
                updateTemplateTags(tagText, 'remove');
            });
        });

        // 更新当前选中模板的标签
        function updateTemplateTags(tagText, action) {
            const activeCard = document.querySelector('.template-card.active');
            if (!activeCard) return;

            const tagsContainer = activeCard.querySelector('.template-tags');

            if (action === 'add') {
                // 检查标签是否已存在
                const existingTags = Array.from(tagsContainer.querySelectorAll('.template-tag'))
                    .map(tag => tag.textContent.trim());

                if (!existingTags.includes(tagText)) {
                    const newTagSpan = document.createElement('span');
                    newTagSpan.className = 'template-tag';
                    newTagSpan.textContent = tagText;
                    tagsContainer.appendChild(newTagSpan);

                    // 添加点击事件用于筛选
                    newTagSpan.addEventListener('click', function (e) {
                        e.stopPropagation();
                        filterTemplatesByTag(tagText);
                    });
                }
            } else if (action === 'remove') {
                // 移除标签
                const tags = tagsContainer.querySelectorAll('.template-tag');
                tags.forEach(tag => {
                    if (tag.textContent.trim() === tagText) {
                        tag.remove();
                    }
                });
            }
        }

        // 添加标签到筛选选项
        function addTagToFilterOptions(tagText) {
            const tagFilterOptions = document.querySelector('.tag-filter-options');

            // 检查是否已存在该标签筛选选项
            const existingOptions = Array.from(tagFilterOptions.querySelectorAll('.tag-filter'))
                .map(option => option.textContent.trim());

            if (!existingOptions.includes(tagText)) {
                const newOption = document.createElement('div');
                newOption.className = 'filter-option tag-filter';
                newOption.textContent = tagText;

                // 添加点击事件
                newOption.addEventListener('click', function () {
                    document.querySelectorAll('.tag-filter').forEach(o => {
                        o.classList.remove('active');
                    });
                    this.classList.add('active');
                    filterTemplatesByTag(tagText);
                });

                tagFilterOptions.appendChild(newOption);
            }
        }

        // 根据标签筛选模板
        function filterTemplatesByTag(tagText) {
            const templateCards = document.querySelectorAll('.template-card');

            templateCards.forEach(card => {
                const cardTags = Array.from(card.querySelectorAll('.template-tag'))
                    .map(tag => tag.textContent.trim());

                if (tagText === '全部' || cardTags.includes(tagText)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // 为现有的模板标签添加点击事件
        document.querySelectorAll('.template-tag').forEach(tag => {
            tag.addEventListener('click', function (e) {
                e.stopPropagation();
                const tagText = this.textContent.trim();
                filterTemplatesByTag(tagText);

                // 高亮对应的筛选选项
                document.querySelectorAll('.tag-filter').forEach(option => {
                    if (option.textContent.trim() === tagText) {
                        document.querySelectorAll('.tag-filter').forEach(o => {
                            o.classList.remove('active');
                        });
                        option.classList.add('active');
                    }
                });
            });
        });

        // 标签筛选选项点击事件
        document.querySelectorAll('.tag-filter').forEach(option => {
            option.addEventListener('click', function () {
                document.querySelectorAll('.tag-filter').forEach(o => {
                    o.classList.remove('active');
                });
                this.classList.add('active');

                const tagText = this.textContent.trim();
                filterTemplatesByTag(tagText);
            });
        });
    </script>
</body>

</html>